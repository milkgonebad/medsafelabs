Notes for Old Port Apothecary or MedSafe Labs, LLC

Templating System:
Twitter Bootstrap


Scaffolding:

If model exists:
rails g scaffold_controller User first_name:string last_name:string email:string address1:string address2:string city:string state:string country:string role:integer

Devise
  # Include default devise modules. Others available are:
  # :confirmable, :lockable, :timeoutable and :omniauthable
  devise :invitable, :database_authenticatable, :registerable,
         :recoverable, :rememberable, :trackable, :validatable --migration false
         
         
Migrating to postgresql

Need to create sequences
http://cmar.me/2011/03/03/mysql-to-postgres-id-column-sequences/

I needed to create on user to seed the sequence.  They should be deleted.
Create the sequence:

SELECT setval('users_id_seq', (SELECT MAX(id) FROM users)+1);
Then add it to the table:
ALTER TABLE users ALTER COLUMN "id" set DEFAULT NEXTVAL('users_id_seq');


Super Admin user:
super@medsafelabs.com
P0rtland!

Test Admin user (on my laptop):
meow@test.com
12345678

Deploying:
git push staging master - staging http://medsafelabs-staging.herokuapp.com
git push heroku master - prod http://medsafelabs.herokuapp.com

heroku run rake db:migrate --remote staging
heroku run rake db:migrate --remote heroku

heroku run rake db:rollback --remote staging
heroku run rake db:rollback --remote heroku


get logs
heroku logs --remote staging

show number of lines:
heroku logs -n 500 --remote staging
or tail
heroku logs --tail --remote staging

heroku run console --remote staging

heroku restart --remote staging


test

trest


TODO
- Turn off allowing users to create accounts for now
- Add an image upload for user's certifications
- Add a confirmation token to users invite acceptance - add more fields to edit with
- if I am admin and I scan a code, I should go to the edit page if the test is in status received, in_progress
- if admin, and I change to in progress, I should edit page
- cannot edit a test if it has not been received
- Need a way to register AND view results for the first time

BACKLOG
- add a subdomain for the heroku app? to be closer and not a herokuapp.com
- add a cron to send expiration reminders
- remove issuing date, add validation for expiring date - and blank out fields on creation form 
- deactivating admins is clunky
- image is lost if validation error
- image should be displayed if editing a test
- Add order history to customer view
- Search for customers
- sort customers/show only active/registered
- notify user daily of completed tests - not one per test
- strains need to be added/updated in the db
- add shopping cart
- integrate with paypal
- Clean up destroy
- Need ID registration info for dispensaries
- Add ability to add more strains
- Add tagging to tests

FIXME
- add password constraints
- security on result images
- prevent deactivated users from logging in
- https://github.com/phatworx/devise_security_extension


DONE
- Configure gitignore
- Do not allow order quantity to be edited in an order
- creating qr codes on the server fails - is error with aws?
- turn on email in staging
- add a way to resend invites
- We should add an active flag or account status flag.
- Convert qrs to real objects with IDs - normalize
- Convert qr_code_number to a real number	
- Add QR code generator - generate new qr codes - need for staging
- Import QR codes
- Cancel account yourself
- should we disable resetting the password in the UI?
- add fields to edit your own acct page
- add password confirmation
- mechanism for updating statuses
- Add edit/show pages for tests
- updated by - tested by fields on the test
- Create QR code controller to do the following:
-- add a new qr code
-- find an existing qr code
-- From there:  show - set received, in progress, complete statuses - need new date fields
--> test pushing db to heroku to make sure sequence id is working
--> Check that user fields are being set



24 images up on Amazon

qr images


qr_image - has an image




